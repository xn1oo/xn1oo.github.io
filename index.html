<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>XN1OO</title>
<style>
body {
  margin: 0;
  height: 100vh;
  background: linear-gradient(to bottom, #0d0d2b, #000000);
  overflow: hidden;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  color: white;
  font-family: "Courier New", monospace;
}

/* Stars */
canvas#stars { position: fixed; top:0; left:0; width:100%; height:100%; z-index:-1; pointer-events:none; }

/* Center text */
#centerText {
  font-size: 4rem;
  color: white;
  text-shadow: 0 0 20px white,0 0 40px white;
  animation: pulse 2s infinite alternate;
  transition: all 1s ease-in-out;
}
@keyframes pulse {
  from { text-shadow:0 0 10px white,0 0 20px white; }
  to { text-shadow:0 0 20px white,0 0 40px white; }
}

/* Play button */
#playButton {
  position: absolute;
  bottom: 20%;
  opacity: 0;
  visibility: hidden;
  padding: 10px 20px;
  width: 120px;
  height: 40px;
  border: none;
  border-radius: 20px;
  background: black;
  color: white;
  font-size: 1rem;
  font-family: "Courier New", monospace;
  text-shadow:0 0 10px white,0 0 20px white;
  cursor: pointer;
  animation: pulse 2s infinite alternate;
  transition: opacity 0.8s ease, visibility 0.8s ease;
}
#playButton.show { opacity:1; visibility:visible; }
.fadeOut { opacity:0 !important; visibility:hidden !important; transition:opacity 1s ease,visibility 1s ease; }
.moveUp { transform: translateY(-150px) scale(0.7); }

/* Moon */
#moon {
  position:absolute;
  top:50px;
  right:100px;
  width:60px;
  height:60px;
  background:white;
  border-radius:50%;
  box-shadow:0 0 20px white,0 0 40px white;
  opacity:0;
  transition: opacity 2s ease;
  cursor:pointer;
}

/* Typing box */
#typingBox {
  margin-top:40px;
  font-size:1.2rem;
  white-space: pre-line;
  text-shadow:0 0 10px white,0 0 20px white;
}
.cursor {
  display:inline-block;
  width:10px;
  background:white;
  margin-left:2px;
  animation: blink 1s infinite;
}
@keyframes blink { 50% { background: transparent; } }

/* Input for name */
#nameInput {
  font-family:"Courier New", monospace;
  font-size:1.2rem;
  padding:5px 8px;
  border-radius:5px;
  border:none;
  outline:none;
  margin-top:10px;
  background:black;
  color:white;
  box-shadow:0 0 10px white;
}

/* Leaderboard */
#leaderboard {
  position:absolute;
  top:50px;
  left:20px;
  width:220px;
  font-family:"Courier New", monospace;
  font-size:1rem;
  text-shadow:0 0 5px white,0 0 10px white;
  display:none;
}

/* Current user display */
#currentUser {
  position: absolute;
  bottom: 30px;
  left: 10px;
  font-family: "Courier New", monospace;
  font-size: 1rem;
  color: white;
  text-shadow: 0 0 10px white, 0 0 20px white;
}

/* Timer */
#timer {
  position:absolute;
  bottom:10px;
  left:10px;
  font-family:"Courier New", monospace;
  font-size:1rem;
  color:white;
  text-shadow:0 0 10px white,0 0 20px white;
}

/* Store GUI */
#storeGUI {
  position: absolute;
  top: 100px;
  left: 100px;
  width: 500px;
  height: 350px;
  background: rgba(255, 255, 255, 0.05); /* transparent */
  backdrop-filter: blur(15px); /* frosted glass */
  border: 2px solid white;
  border-radius: 10px;
  box-shadow: 0 0 20px white, 0 0 40px white;
  display: none;
  cursor: grab;
  overflow: hidden;
  padding: 5px 10px;
}

#storeHeader {
  font-family: "Courier New", monospace;
  font-size: 1.2rem;
  text-align: center;
  background: rgba(255, 255, 255, 0.05);
  padding: 5px;
  border-bottom: 1px solid white;
  color: white;
  text-shadow: 0 0 10px white, 0 0 20px white;
  user-select: none;
  cursor: grab;
}

.storeSection { margin-top: 10px; }
.sectionTitle {
  font-family: "Courier New", monospace;
  font-size: 1rem;
  color: white;
  padding: 5px;
  text-shadow: 0 0 5px white,0 0 10px white;
  cursor: pointer;
  user-select: none;
}
.sectionContent {
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.5s ease;
  margin-left: 10px;
}
.storeItem {
  padding: 5px 0;
  cursor: pointer;
  text-shadow: 0 0 5px white,0 0 10px white;
  color: white;
}
.storeItem:hover {
  text-shadow: 0 0 10px #00ffff, 0 0 20px #00ffff;
  color: #00ffff;
}
</style>
</head>
<body>
<canvas id="stars"></canvas>

<div id="centerText">X N 1 O O</div>
<button id="playButton">PLAY</button>
<div id="moon"></div>
<div id="typingBox"><span id="typedText"></span><span class="cursor"></span></div>
<div id="leaderboard"></div>
<div id="currentUser">Your name: </div>
<div id="timer">Time: 0 min</div>

<!-- Store GUI -->
<div id="storeGUI">
  <div id="storeHeader">Store</div>
  <div class="storeSection">
    <div class="sectionTitle">Name Effects</div>
    <div class="sectionContent">
      <div class="storeItem">Sparkles</div>
      <div class="storeItem">Flash</div>
      <div class="storeItem">Snow</div>
    </div>
  </div>
  <div class="storeSection">
    <div class="sectionTitle">Name Colors</div>
    <div class="sectionContent">
      <div class="storeItem">Pink</div>
      <div class="storeItem">Red</div>
      <div class="storeItem">Blue</div>
      <div class="storeItem">Orange</div>
      <div class="storeItem">Black</div>
    </div>
  </div>
</div>

<!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
// ===== FIREBASE CONFIG =====
const firebaseConfig = {
  apiKey: "AIzaSyB4CcE_afYUrjwpp_DCaJwUuow478JRfP8",
  authDomain: "xn1oo-bb64d.firebaseapp.com",
  databaseURL: "https://xn1oo-bb64d-default-rtdb.firebaseio.com",
  projectId: "xn1oo-bb64d",
  storageBucket: "xn1oo-bb64d.firebasestorage.app",
  messagingSenderId: "767448528500",
  appId: "1:767448528500:web:6a39c8c16abb037643c321",
  measurementId: "G-TMZ3FH9WL0"
};
firebase.initializeApp(firebaseConfig);
const database = firebase.database();

// ===== STAR BACKGROUND =====
const canvas = document.getElementById('stars');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;
let stars=[];
for(let i=0;i<200;i++){stars.push({x:Math.random()*canvas.width,y:Math.random()*canvas.height,size:Math.random()*2,speed:Math.random()*0.5});}
function drawStars(){ctx.clearRect(0,0,canvas.width,canvas.height);ctx.fillStyle="white";stars.forEach(star=>{ctx.beginPath();ctx.arc(star.x,star.y,star.size,0,Math.PI*2);ctx.fill();star.y+=star.speed;if(star.y>canvas.height){star.y=0;star.x=Math.random()*canvas.width;}});requestAnimationFrame(drawStars);}
drawStars();

// ===== ELEMENTS =====
const playButton = document.getElementById("playButton");
const centerText = document.getElementById("centerText");
const moon = document.getElementById("moon");
const typedText = document.getElementById("typedText");
const typingBox = document.getElementById("typingBox");
const leaderboard = document.getElementById("leaderboard");
const currentUserDiv = document.getElementById("currentUser");
const storeGUI = document.getElementById("storeGUI");
const storeHeader = document.getElementById("storeHeader");

// ===== TIMER =====
let minutes = parseInt(localStorage.getItem("xn1ooTime") || "0");
const timer = document.getElementById("timer");
timer.textContent = "Time: " + minutes + " min";

setInterval(()=>{
  minutes++;
  timer.textContent = "Time: "+minutes+" min";
  localStorage.setItem("xn1ooTime", minutes);
  const storedName = localStorage.getItem("xn1ooName");
  if(storedName){
    database.ref('users/'+storedName).set({name:storedName,time:minutes});
  }
},60000);

// ===== PLAY BUTTON =====
setTimeout(()=>{playButton.classList.add("show");},2000);
playButton.addEventListener("click",()=>{
  playButton.classList.remove("show");
  playButton.classList.add("fadeOut");
  centerText.classList.add("moveUp");
  setTimeout(()=>{
    moon.style.opacity=1;
    setTimeout(runCodeTyping,2000);
  },1200);
});

// ===== SLOW TYPING FUNCTION =====
function typeLine(line, callback, speed=100){
  let i=0;
  function typeChar(){
    if(i<line.length){
      typedText.textContent+=line.charAt(i);
      i++;
      setTimeout(typeChar,speed);
    } else callback();
  }
  typeChar();
}

// ===== TYPING MESSAGES =====
const messages = [
  ["Welcome,",1000," to my Website."],
  ["I Created this while I was sick at home,",1000," and also because I was bored."],
  ["But anyways just sit here and just do whatever"]
];

let msgIndex=0;
let partIndex=0;

function runCodeTyping(){
  if(msgIndex<messages.length){
    const parts = messages[msgIndex];
    function typeNextPart(){
      if(partIndex<parts.length){
        if(typeof parts[partIndex]==="string"){
          typeLine(parts[partIndex],()=>{partIndex++;typeNextPart();},100);
        } else if(typeof parts[partIndex]==="number"){
          setTimeout(()=>{partIndex++;typeNextPart();},parts[partIndex]);
        }
      } else {
        msgIndex++;
        partIndex=0;
        typedText.textContent+="\n";
        runCodeTyping();
      }
    }
    typeNextPart();
  } else {
    checkName();
  }
}

// ===== CURRENT USER DISPLAY =====
function updateCurrentUserName() {
  const storedName = localStorage.getItem("xn1ooName");
  if(storedName){
    currentUserDiv.textContent = "Your name: " + storedName;
  }
}

// ===== CHECK NAME =====
function checkName(){
  const storedName = localStorage.getItem("xn1ooName");
  if(storedName){
    typedText.textContent="";
    updateCurrentUserName();
    typeLine("Hello, "+storedName,()=>{
      setTimeout(()=>{typedText.style.display="none"; showGlobalLeaderboard();},1000);
    },100);
  } else {
    startNamePrompt();
  }
}

// ===== ASK FOR NAME =====
function startNamePrompt(){
  typedText.textContent="What's your name? ";
  const input = document.createElement("input");
  input.id="nameInput";
  typingBox.appendChild(input);
  input.focus();
  input.addEventListener("keydown",(e)=>{
    if(e.key==="Enter" && input.value.trim()!==""){
      const name=input.value.trim();
      localStorage.setItem("xn1ooName", name);
      updateCurrentUserName();
      typingBox.innerHTML="";
      typeLine("Hello, "+name,()=>{
        setTimeout(()=>{typedText.style.display="none"; showGlobalLeaderboard();},1000);
      },100);
      database.ref('users/'+name).set({name:name,time:minutes});
    }
  });
}

// ===== GLOBAL LEADERBOARD =====
function showGlobalLeaderboard(){
  leaderboard.style.display="block";  
  const storedName = localStorage.getItem("xn1ooName");
  database.ref('users').on('value', (snapshot)=>{
    const data = snapshot.val();
    if(!data) return;
    const sortedUsers = Object.values(data).sort((a,b)=>b.time - a.time);
    leaderboard.innerHTML = "<strong>Leaderboard:</strong><br>";
    sortedUsers.forEach((u,i)=>{
      const entry = document.createElement("div");
      entry.textContent = `${i+1}. ${u.name}: ${u.time} min`;
      if(u.name === storedName){
        entry.style.color = "#00ffff";
        entry.style.textShadow = "0 0 5px #00ffff,0 0 10px #00ffff";
        entry.style.fontWeight = "bold";
      }
      leaderboard.appendChild(entry);
    });
  });
}

// ===== MOON CLICK TO TOGGLE STORE =====
moon.addEventListener("click", () => { storeGUI.classList.toggle("show"); });

// ===== DRAG STORE GUI =====
let isDragging=false, offsetX=0, offsetY=0;
storeHeader.addEventListener("mousedown", (e)=>{
  isDragging=true;
  offsetX=e.clientX-storeGUI.offsetLeft;
  offsetY=e.clientY-storeGUI.offsetTop;
  storeGUI.style.cursor="grabbing";
});
document.addEventListener("mouseup",()=>{isDragging=false; storeGUI.style.cursor="grab";});
document.addEventListener("mousemove",(e)=>{
  if(isDragging){
    let x=e.clientX-offsetX;
    let y=e.clientY-offsetY;
    x=Math.max(0,Math.min(window.innerWidth-storeGUI.offsetWidth,x));
    y=Math.max(0,Math.min(window.innerHeight-storeGUI.offsetHeight,y));
    storeGUI.style.left=x+"px";
    storeGUI.style.top=y+"px";
  }
});

// ===== COLLAPSIBLE SECTIONS =====
document.querySelectorAll('.sectionTitle').forEach(title=>{
  title.addEventListener('click',()=>{
    const content = title.nextElementSibling;
    if(content.style.maxHeight){
      content.style.maxHeight = null;
    } else {
      content.style.maxHeight = content.scrollHeight + "px";
    }
  });
});

// ===== STORE ITEM CLICK EVENTS =====
document.querySelectorAll('.storeItem').forEach(item=>{
  item.addEventListener('click',()=>{
    console.log('Clicked:',item.textContent);
    // Add effect/color functionality here
  });
});

window.addEventListener("load", updateCurrentUserName);
</script>
</body>
</html>
